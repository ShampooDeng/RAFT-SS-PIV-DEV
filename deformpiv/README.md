The code is adopted from https://github.com/yongleex/DiffeomorphicPIV.